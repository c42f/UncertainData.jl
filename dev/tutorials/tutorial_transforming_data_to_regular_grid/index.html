<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transforming uncertain data to a regular grid Â· UncertainData.jl documentation</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">UncertainData.jl documentation</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">UncertainData.jl</a></li><li><span class="tocitem">Uncertain values</span><ul><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_overview/">Uncertain value types</a></li><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_theoreticaldistributions/">Theoretical distributions</a></li><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_kde/">Kernel density estimated distributions</a></li><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_fitted/">Fitted theoretical distributions</a></li><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_certainvalue/">Generic constructor</a></li><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_populations/">Weighted populations</a></li><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_Measurements/">Generic constructor</a></li><li><a class="tocitem" href="../../uncertain_values/merging/">Nomenclature</a></li><li><a class="tocitem" href="../../uncertain_values/uncertainvalues_examples/">Example 1: Uncertain values defined by theoretical distributions</a></li></ul></li><li><span class="tocitem">Uncertain datasets</span><ul><li><a class="tocitem" href="../../uncertain_datasets/uncertain_datasets_overview/">Types of uncertain value collections</a></li><li><a class="tocitem" href="../../uncertain_datasets/uncertain_index_dataset/">Uncertain index datasets</a></li><li><a class="tocitem" href="../../uncertain_datasets/uncertain_value_dataset/">Uncertain value datasets</a></li><li><a class="tocitem" href="../../uncertain_datasets/uncertain_indexvalue_dataset/">Uncertain index-value datasets</a></li><li><a class="tocitem" href="../../uncertain_datasets/uncertain_dataset/">Generic uncertain datasets</a></li></ul></li><li><span class="tocitem">Uncertain statistics</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Core statistics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../uncertain_statistics/core_stats/core_statistics/">Statistics on uncertain values and collections</a></li><li><a class="tocitem" href="../../uncertain_statistics/core_stats/core_statistics_point_estimates/">Point-estimate statistics</a></li><li><a class="tocitem" href="../../uncertain_statistics/core_stats/core_statistics_pairwise_estimates/">Pairwise estimates of statistics</a></li><li><a class="tocitem" href="../../uncertain_statistics/core_stats/core_statistics_datasets_single_dataset_estimates/">Statistics on single collections of uncertain data</a></li><li><a class="tocitem" href="../../uncertain_statistics/core_stats/core_statistics_datasets_pairwise_estimates/">Pairwise statistics on uncertain data collections</a></li><li><a class="tocitem" href="../../uncertain_statistics/core_stats/core_statistics_datasets/">Statistics on datasets of uncertain values</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Hypothesis tests</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/hypothesis_tests_overview/">Hypothesis tests for uncertain values and collections</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/one_sample_t_test/">One-sample t-test</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/equal_variance_t_test/">Equal variance t-test</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/unequal_variance_t_test/">Unequal variance t-test</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/exact_kolmogorov_smirnov_test/">Exact two-sample Kolmogorov-Smirnov test</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/approximate_twosample_kolmogorov_smirnov_test/">Approximate two-sample Kolmogorov-Smirnov test</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/jarque_bera_test/">Jarque-Bera test</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/mann_whitney_u_test/">Mann-Whitney U-test</a></li><li><a class="tocitem" href="../../uncertain_statistics/hypothesistests/anderson_darling_test/">Anderson-darling test</a></li></ul></li></ul></li><li><span class="tocitem">Sampling constraints</span><ul><li><a class="tocitem" href="../../sampling_constraints/available_constraints/">Available sampling constraints</a></li><li><a class="tocitem" href="../../sampling_constraints/constrain_uncertain_values/">Documentation</a></li><li><a class="tocitem" href="../../sampling_constraints/sequential_constraints/">Increasing/decreasing</a></li></ul></li><li><span class="tocitem">Binning</span><ul><li><a class="tocitem" href="../../binning/bin/">Binning scalar values</a></li></ul></li><li><span class="tocitem">Resampling</span><ul><li><a class="tocitem" href="../../resampling/resampling_overview/">Overview</a></li><li><a class="tocitem" href="../../resampling/resampling_uncertain_values/">Resampling uncertain values</a></li><li><a class="tocitem" href="../../resampling/resampling_uncertain_datasets/"><code>UncertainDataset</code></a></li><li><a class="tocitem" href="../../resampling/resampling_uncertain_indexvalue_datasets/"><code>UncertainIndexValueDataset</code></a></li><li><a class="tocitem" href="../../resampling/sequential/resampling_uncertaindatasets_sequential/">Is a particular constraint applicable?</a></li><li><a class="tocitem" href="../../resampling/sequential/resampling_indexvalue_sequential/">Resampling syntax</a></li><li><a class="tocitem" href="../../resampling/sequential/strictly_increasing/">Strictly increasing</a></li><li><a class="tocitem" href="../../resampling/sequential/strictly_decreasing/">Strictly decreasing</a></li><li><a class="tocitem" href="../../resampling/interpolation/interpolation/">Supported interpolations</a></li><li><a class="tocitem" href="../../resampling/interpolation/gridded/">Grids</a></li><li><a class="tocitem" href="../../resampling/resampling_schemes/resampling_schemes_uncertain_value_collections/">List of resampling schemes and their purpose</a></li><li><a class="tocitem" href="../../resampling/resampling_schemes/resampling_schemes_uncertain_indexvalue_collections/">List of resampling schemes and their purpose</a></li><li><a class="tocitem" href="../../resampling/resampling_schemes/resampling_with_schemes_uncertain_value_collections/">Resampling with schemes</a></li><li><a class="tocitem" href="../../resampling/resampling_schemes/resampling_with_schemes_uncertain_indexvalue_collections/">Resampling schemes</a></li><li><a class="tocitem" href="../../resampling/resampling_inplace/">In-place resampling</a></li></ul></li><li><span class="tocitem">Propagation of errors</span><ul><li><a class="tocitem" href="../../propagation_of_errors/propagation_of_errors/">Exact error propagation</a></li></ul></li><li><span class="tocitem">Mathematics</span><ul><li><a class="tocitem" href="../../mathematics/elementary_operations/">Elementary mathematical operations</a></li><li><a class="tocitem" href="../../mathematics/trig_functions/">Trigonometric functions</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorial_overview/">Regularising uncertain data</a></li><li class="is-active"><a class="tocitem" href>Transforming uncertain data to a regular grid</a><ul class="internal"><li><a class="tocitem" href="#Some-example-data"><span>Some example data</span></a></li><li><a class="tocitem" href="#BinnedMeanResampling"><span><code>BinnedMeanResampling</code></span></a></li><li><a class="tocitem" href="#BinnedResampling"><span><code>BinnedResampling</code></span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../implementing_algorithms_for_uncertaindata/">Extending existing algorithms for uncertain data types</a></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li><li><a class="tocitem" href="../../publications/">Publications/software</a></li><li><a class="tocitem" href="../../citing/">Citing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Transforming uncertain data to a regular grid</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transforming uncertain data to a regular grid</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kahaaga/UncertainData.jl/blob/master/docs/src/tutorials/tutorial_transforming_data_to_regular_grid.md" title="Edit on GitHub"><span class="docs-icon fab">ï</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="transform_data_to_regular_grid"><a class="docs-heading-anchor" href="#transform_data_to_regular_grid">Transforming uncertain data to a regular grid</a><a id="transform_data_to_regular_grid-1"></a><a class="docs-heading-anchor-permalink" href="#transform_data_to_regular_grid" title="Permalink"></a></h1><p>Time series analysis algorithms often require data that are equally spaced in time.  Dealing with data that have uncertainties both in values and in time, that becomes tricky. A solution is to partition the time axis into bins of a certain size, transform  your data onto those bins, the compute your statistic on the transformed data.</p><p>This tutorial shows how uncertain data can be transformed to a regular grid using a  combination of resampling and binning.</p><h2 id="Some-example-data"><a class="docs-heading-anchor" href="#Some-example-data">Some example data</a><a id="Some-example-data-1"></a><a class="docs-heading-anchor-permalink" href="#Some-example-data" title="Permalink"></a></h2><p>We&#39;ll look at the first and second variables of an autoregressive system with  unidirectional coupling. We&#39;ll use 100 points where each time point is spaced  10 time unit apart. In addition we&#39;ll make the positions of the time indices, as  well as the actual values of the time series, uncertain.</p><p>To do this, we&#39;ll use the <code>example_uncertain_indexvalue_datasets</code> function that ships with  <code>UncertainData.jl</code>. It takes as input a <code>DiscreteDynamicalSystem</code> instance, the number of desired points, and which variables of the system to use for the  time series. Time series will be generated from a unidirectionally  coupled AR1 system from the <a href="https://github.com/kahaaga/CausalityTools.jl">CausalityTools</a>  package. To simulate real-world data, some noise is added to the values and  indices.</p><pre><code class="language-julia hljs">using UncertainData, CausalityTools, Plots

system = CausalityTools.ar1_unidir(c_xy = 0.5)
vars = (1, 2)
npts, tstep = 100, 10

d_xind, d_yind = Uniform(2.5, 15.5), Uniform(2.5, 15.5)
d_xval, d_yval = Uniform(0.01, 0.2), Uniform(0.01, 0.2)

X, Y = example_uncertain_indexvalue_datasets(system,
    npts, vars, tstep = tstep,
    d_xind = d_xind, d_yind = d_yind,
    d_xval = d_xval, d_yval = d_yval);</code></pre><p>Let&#39;s plot the data.</p><pre><code class="language-julia hljs">qs = [0.05, 0.95] # use the same quantile ranges for both indices and values
plot(X, qs, qs, ms = 2, c = :black, marker = stroke(0.01, :black), 
    xlabel = &quot;Time step&quot;, ylabel = &quot;Value&quot;)</code></pre><p><img src="../imgs/example_timeseries_X.svg" alt/></p><p>Our data have uncertain time indices, so they are not on a regularly spaced grid. Let&#39;s say we want a grid where the left bin edges range from <code>0</code> to <code>1000</code> in  steps of <code>50</code>. Superimposed on our data, that grid looks as follows.</p><pre><code class="language-julia hljs">resampling = BinnedResampling(0:50:1000, 1000)

qs = [0.05, 0.95] # plotting quantile ranges
plot(X, qs, qs, ms = 2, c = :black, marker = stroke(0.01, :black), 
    xlabel = &quot;Time step&quot;, ylabel = &quot;Value&quot;)
vline!(0:50:1000 |&gt; collect, label = &quot;&quot;, c = :grey, lw = 0.5, ls = :dash)</code></pre><p><img src="../imgs/example_timeseries_X_binning.svg" alt/></p><h2 id="BinnedMeanResampling"><a class="docs-heading-anchor" href="#BinnedMeanResampling"><code>BinnedMeanResampling</code></a><a id="BinnedMeanResampling-1"></a><a class="docs-heading-anchor-permalink" href="#BinnedMeanResampling" title="Permalink"></a></h2><p>Assume that the uncertainties in the time values are independent. Bin averages  can then be obtained by resampling every uncertain value in the dataset  many times, keeping track of which draws falls in which time bins, then taking the average of the draws in each of the bins. We&#39;ll resample each point  <code>10000</code> times. In total, the bin means are then computed based on  <code>100*10000</code> draws of the values in the dataset (we constructed the dataset  so that it has 100 points).</p><pre><code class="language-julia hljs">resampling = BinnedMeanResampling(0:50:1000, 10000)
X_binned_means = resample(X, resampling); # returns a vector of bin means

p = plot(xlabel = &quot;Time step&quot;, ylabel = &quot;Value&quot;)
plot!(X, c = :blue, ms = 2, marker = stroke(0.01, :black), [0.1, 0.9], [0.1, 0.9])
plot!(inds, X_binned_means, ms = 2, marker = stroke(1.0), lw = 1, c = :black, label = &quot;bin mean&quot;)
vline!(resampling.left_bin_edges, label = &quot;&quot;, c = :grey, lw = 0.5, ls = :dash)</code></pre><p><img src="../imgs/BinnedMeanResampling.svg" alt/></p><p>OK, that looks like a reasonable estimate to the mean at this coarser resolution.  But what if we need more information about each bin than just the mean? The solution  is to explicitly keep track of the draws in each bin, then representing those draws  as a distribution.</p><h2 id="BinnedResampling"><a class="docs-heading-anchor" href="#BinnedResampling"><code>BinnedResampling</code></a><a id="BinnedResampling-1"></a><a class="docs-heading-anchor-permalink" href="#BinnedResampling" title="Permalink"></a></h2><p>Assume again that the uncertainties in the time values are independent. However, instead of using bin averages, we&#39;re interested in keeping track of the uncertainties in each bin. Again, resample the values in the dataset many times, but this time,  instead of directly computing the bin means, we keep track of all draws falling  in a particular bin. Uncertainties in a bin is then estimated by a kernel density  estimate over the draws falling in that bin.</p><p>Again, we&#39;ll sample each point in the dataset <code>10000</code> times, yielding a total  of <code>100*10000</code> draws from which the kernel-density-estimated distributions are  estimated. Some bins may have more draws than others.</p><pre><code class="language-julia hljs">resampling = BinnedResampling(0:50:1000, 1000)
X_binned = resample(X, resampling)</code></pre><p><code>X_binned</code> is still a <code>UncertainIndexValueDataset</code>, but the indices have been reduced  to <code>CertainValue</code> instances placed at the bin midpoints. The values, however, are kept  as uncertain values.</p><p>Plotting the result:</p><pre><code class="language-julia hljs">
# Plot the 90 percentile ranges for both the original distributions/populations and 
# the binned distributions/populations
qs = [0.05, 0.95]
ql = quantile.(X_binned.values, 0.05, 10000)
qh = quantile.(X_binned.values, 0.95, 10000)

plot(xlabel = &quot;Time step&quot;, ylabel = &quot;Value&quot;)

# Original dataset, bin edges and resampled dataset
plot!(X, c = :blue, ms = 2, marker = stroke(0.01, :black), qs, qs)

vline!(resampling.left_bin_edges, label = &quot;&quot;, c = :grey, lw = 0.5, ls = :dash)
plot!(X_binned, c = :red, ms = 4, marker = stroke(0.01, :red), qs, qs, alpha = 0.5)

# Get the bin edges and the quantiles as a band
g = resampling.left_bin_edges
inds = g[1:end-1] .+ step(g)/2
plot!(inds, qh, label = &quot;&quot;, c = :red, Î± = 0.5, ls = :dash)
plot!(inds, ql, label = &quot;&quot;, c = :red, Î± = 0.5, ls = :dash)</code></pre><p><img src="../imgs/BinnedResampling.svg" alt/></p><p>This binned <code>UncertainIndexValueDataset</code> can now be resampled by calling  <code>resample(X_binned)</code>, which will every time yield independent realisations  that are on the same time grid.</p><pre><code class="language-julia hljs">p = plot(xlabel = &quot;Time step&quot;, ylabel = &quot;Value&quot;)

for i = 1:10
    timeinds, vals = resample(X_binned)
    plot!(timeinds, vals, 
        c = :black, lw = 0.5, ms = 1, 
        marker = stroke(0.4, :black), label = &quot;&quot;)
end

vline!(resampling.left_bin_edges, label = &quot;&quot;, c = :grey, lw = 0.5, ls = :dash)
p</code></pre><p><img src="../imgs/BinnedResampling_example_draws.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial_overview/">Â« Regularising uncertain data</a><a class="docs-footer-nextpage" href="../../implementing_algorithms_for_uncertaindata/">Extending existing algorithms for uncertain data types Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 19 November 2021 20:37">Friday 19 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
